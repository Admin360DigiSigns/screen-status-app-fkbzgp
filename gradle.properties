
# Project-wide Gradle settings for Expo/React Native

# Specifies the JVM arguments used for the daemon process.
# ULTRA-MAXIMIZED MEMORY ALLOCATION - CRITICAL FOR METASPACE ERROR
org.gradle.jvmargs=-Xmx16384m -XX:MaxMetaspaceSize=8192m -XX:ReservedCodeCacheSize=2048m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8 -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -XX:G1HeapRegionSize=32m

# DISABLE parallel builds to reduce memory pressure
org.gradle.parallel=false

# REDUCE Gradle daemon workers to prevent memory exhaustion
org.gradle.workers.max=1

# Disable configuration cache to save memory
org.gradle.configuration-cache=false
org.gradle.configuration-cache.problems=warn

# Enable build cache
org.gradle.caching=true

# AndroidX
android.useAndroidX=true
android.enableJetifier=true

# Kotlin compiler memory settings (critical for KSP) - ULTRA-MAXIMIZED FOR METASPACE
kotlin.daemon.jvmargs=-Xmx10240m -XX:MaxMetaspaceSize=6144m -XX:ReservedCodeCacheSize=2048m -XX:+UseG1GC -XX:MaxGCPauseMillis=200

# KAPT memory settings - ULTRA-MAXIMIZED
kapt.daemon.jvm.options=-Xmx10240m -XX:MaxMetaspaceSize=6144m

# Disable R8 full mode to save memory
android.enableR8.fullMode=false

# Increase daemon idle timeout
org.gradle.daemon.idletimeout=3600000

# Optimize Dex in process
android.enableDexingArtifactTransform=false

# Disable unnecessary features to save memory
android.enableBuildCache=true
android.enableD8.desugaring=true

# KSP-specific memory settings - CRITICAL FOR METASPACE ERROR
ksp.incremental=false
ksp.incremental.intermodule=false
ksp.use.worker.api=false

# Reduce Kotlin compiler memory pressure
kotlin.incremental=false
kotlin.compiler.execution.strategy=in-process

# Disable Gradle daemon performance logging
org.gradle.daemon.performance.disable-logging=true

# Additional memory optimization flags
org.gradle.jvmargs.kapt=-Xmx10240m -XX:MaxMetaspaceSize=6144m
org.gradle.jvmargs.kotlin=-Xmx10240m -XX:MaxMetaspaceSize=6144m

# Force single-threaded compilation for KSP
kotlin.compiler.execution.strategy=in-process
kotlin.parallel.tasks.in.project=false
